local GuiLibrary = {}

-- Function to make frames draggable
function GuiLibrary.makeDraggable(frame, window)
    local dragging = false
    local dragStart = nil
    local startPos = nil

    local function onDragStart(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = window.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end

    local function onDragInput(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            if dragging then
                local delta = input.Position - dragStart
                window.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end
    end

    frame.InputBegan:Connect(onDragStart)
    frame.InputChanged:Connect(onDragInput)
end

-- Function to create a ScreenGui
function GuiLibrary.createScreenGui()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    return screenGui
end

-- Function to create a Window
function GuiLibrary.createWindow(parent)
    local window = Instance.new("Frame", parent)
    window.Name = "Window"
    window.BackgroundColor3 = Color3.fromRGB(44, 44, 44)
    window.BorderSizePixel = 0
    window.Size = UDim2.new(0, 300, 0, 250)
    window.Position = UDim2.new(0.5, -150, 0.5, -125)
    window.ZIndex = 2

    -- Title Frame
    local titleFrame = Instance.new("Frame", window)
    titleFrame.Name = "TitleFrame"
    titleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    titleFrame.Size = UDim2.new(1, 0, 0, 24)
    titleFrame.ZIndex = 2

    -- Title Label
    local title = Instance.new("TextLabel", titleFrame)
    title.Name = "Title"
    title.BackgroundTransparency = 1
    title.Size = UDim2.new(1, 0, 1, 0)
    title.Font = Enum.Font.GothamBold
    title.Text = "Minty Hub"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 18
    title.ZIndex = 3

    -- Make the entire window draggable
    GuiLibrary.makeDraggable(titleFrame, window)

    -- Tab Frame
    local tabFrame = Instance.new("Frame", window)
    tabFrame.Name = "TabFrame"
    tabFrame.BackgroundColor3 = Color3.fromRGB(55, 55, 55)
    tabFrame.BorderSizePixel = 0
    tabFrame.Size = UDim2.new(1, 0, 0, 50) -- Adjust the height as needed
    tabFrame.Position = UDim2.new(0, 0, 0, titleFrame.Size.Y.Offset)
    tabFrame.ZIndex = 2

    window.TabFrame = tabFrame

    return window
end

-- Function to create a Tab inside the TabFrame
function GuiLibrary.createTab(window, tabName)
    local tabFrame = window.TabFrame

    local tab = Instance.new("TextButton", tabFrame)
    tab.Name = tabName
    tab.BackgroundColor3 = Color3.fromRGB(45, 45, 45)  -- Dark color for tabs
    tab.Size = UDim2.new(0, 100, 1, 0)  -- Small, fixed width for the tab buttons
    tab.ZIndex = 3
    tab.TextColor3 = Color3.fromRGB(255, 255, 255)
    tab.Font = Enum.Font.SourceSans
    tab.TextSize = 18
    tab.Text = tabName

    -- The autoSort function will arrange the tabs horizontally within the TabFrame
    local function autoSort()
        local xPos = 0
        for i, element in ipairs(tabFrame:GetChildren()) do
            if element:IsA("TextButton") then
                -- Update each tab's size to be a small rectangle if they are not
                element.Size = UDim2.new(0, 100, 0, 24)
                element.Position = UDim2.new(0, xPos, 0, 0)
                xPos = xPos + element.AbsoluteSize.X + 2  -- Place the next tab right next to the current one
            end
        end
    end

    -- Connect the autoSort function to the ChildAdded and ChildRemoved events of the TabFrame
    tabFrame.ChildAdded:Connect(autoSort)
    tabFrame.ChildRemoved:Connect(autoSort)

    autoSort()  -- Initial sort of the tabs

    return tab
end

-- Function to create a Button within a Tab
function GuiLibrary.createButton(tab, name, callback)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Parent = tab
    button.Text = name
    button.Size = UDim2.new(1, -20, 0, 50) -- Full width inside the tab, with some padding
    button.Position = UDim2.new(0, 10, 0, 25) -- Positioned below the tab buttons
    button.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.SourceSans
    button.TextSize = 18
    button.ZIndex = 2

    button.MouseButton1Click:Connect(callback)

    return button
end

-- Create the main GUI container
local screenGui = GuiLibrary.createScreenGui()
local window = GuiLibrary.createWindow(screenGui)

-- Create tabs within the window's TabFrame
local tab1 = GuiLibrary.createTab(window, "Tab1")
local tab2 = GuiLibrary.createTab(window, "Tab2")
-- You can continue adding tabs as needed

-- Now, use the `tab1` and `tab2` frames to create buttons within those tabs
local button1 = GuiLibrary.createButton(tab1, "Button1", function()
    print("Button1 clicked in Tab1")
end)

local button2 = GuiLibrary.createButton(tab2, "Button2", function()
    print("Button2 clicked in Tab2")
end)
